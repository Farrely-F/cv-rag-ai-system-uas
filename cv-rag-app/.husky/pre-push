#!/bin/sh

echo ""
echo "üöÄ ======================="
echo "   PRE-PUSH HOOK"
echo "   Validating build before push..."
echo "=========================="
echo ""

# Run TypeScript type checking
echo "üîé Running TypeScript type check..."
npx tsc --noEmit

if [ $? -ne 0 ]; then
  echo ""
  echo "‚ùå =========================="
  echo "   PUSH BLOCKED"
  echo "   TypeScript compilation failed."
  echo "   Please fix the type errors above and try again."
  echo "==========================="
  echo ""
  exit 1
fi

echo "‚úÖ TypeScript check passed!"
echo ""

# Run production build
echo "üèóÔ∏è  Building production bundle..."
npm run build

if [ $? -ne 0 ]; then
  echo ""
  echo "‚ùå =========================="
  echo "   PUSH BLOCKED"
  echo "   Build failed."
  echo "   Please fix the build errors above and try again."
  echo "==========================="
  echo ""
  exit 1
fi

echo ""
echo "‚úÖ =========================="
echo "   PRE-PUSH PASSED"
echo "   Build completed successfully!"
echo "   Pushing to remote..."
echo "==========================="
echo ""
